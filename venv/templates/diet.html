<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Document</title>
</head>


<body class="bg-cyan-900 text-white flex flex-col min-h-screen">
    <main class="flex-1">
        <section class="flex items-center justify-center min-h-screen h-full">
            <div class="space-y-6 w-full">
                <div class="flex justify-center">
                    <a class="flex gap-1 items-center" href="/">
                        <img class="mix-blend-darken"
                            src="../static/bodybuilder-strong-man-black-silhouette-design-vector-40588031.webp"
                            alt="LOGO" height="60" width="60">
                    </a>
                </div>
                <div class="flex flex-col md:flex-row gap-4 justify-evenly items-center h-full w-full">
                    <div class="bg-white rounded-lg shadow-lg p-4 text-black">
                        <h1 class="text-2xl font-bold text-center">Macronutrients Chart
                        </h1>
                        <table class="table-auto text-center">
                            <thead>
                                <tr>
                                    <th class="p-2 py-1">Name</th>
                                    <th class="p-2 py-1">Protein</th>
                                    <th class="p-2 py-1">Fat</th>
                                    <th class="p-2 py-1">Carbs</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="text-center">
                                    <td class="p-2 py-1">Black Chana (50g)</td>
                                    <td class="p-2 py-1">14</td>
                                    <td class="p-2 py-1">2</td>
                                    <td class="p-2 py-1">29</td>
                                </tr>
                                <tr class="text-center">
                                    <td class="p-2 py-1">Green Gram(50g)</td>
                                    <td class="p-2 py-1">12</td>
                                    <td class="p-2 py-1">0.6</td>
                                    <td class="p-2 py-1">32</td>
                                </tr>
                                <tr class="text-center">
                                    <td class="p-2 py-1">Boil Egg</td>
                                    <td class="p-2 py-1">6</td>
                                    <td class="p-2 py-1">4.5</td>
                                    <td class="p-2 py-1">1</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Chicken Breast (medium)</td>
                                    <td class="p-2 py-1">35.5</td>
                                    <td class="p-2 py-1">6.5</td>
                                    <td class="p-2 py-1">-</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Oats (50g)</td>
                                    <td class="p-2 py-1">11</td>
                                    <td class="p-2 py-1">8</td>
                                    <td class="p-2 py-1">30</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Wheat Bread</td>
                                    <td class="p-2 py-1">2</td>
                                    <td class="p-2 py-1">0.6</td>
                                    <td class="p-2 py-1">6.9</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Soya Chunks (40g)</td>
                                    <td class="p-2 py-1">20.5</td>
                                    <td class="p-2 py-1">0.3</td>
                                    <td class="p-2 py-1">11.5</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Chapati</td>
                                    <td class="p-2 py-1">0.7</td>
                                    <td class="p-2 py-1">1.5</td>
                                    <td class="p-2 py-1">15</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Mutton (100g)</td>
                                    <td class="p-2 py-1">18</td>
                                    <td class="p-2 py-1">18</td>
                                    <td class="p-2 py-1">-</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Beef (100g)</td>
                                    <td class="p-2 py-1">25.9</td>
                                    <td class="p-2 py-1">15.4</td>
                                    <td class="p-2 py-1">-</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Fish (100g)</td>
                                    <td class="p-2 py-1">13.3</td>
                                    <td class="p-2 py-1">6.7</td>
                                    <td class="p-2 py-1">66.7</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Pasta (100g)</td>
                                    <td class="p-2 py-1">5.2</td>
                                    <td class="p-2 py-1">1.1</td>
                                    <td class="p-2 py-1">24.9</td>
                                </tr>
                                <tr>
                                    <td class="p-2 py-1">Rice (100g)</td>
                                    <td class="p-2 py-1">2.36</td>
                                    <td class="p-2 py-1">0.19</td>
                                    <td class="p-2 py-1">28.7</td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                    <div class="bg-white rounded-lg shadow-lg p-4 text-black h-full">
                        <h1 class="text-2xl font-bold">Calorie Chart</h1>
                        <p>
                            1 gm carbs = 4 calories
                        </p>
                        <p>
                            1 gm protein = 4 calories
                        </p>
                        <p>
                            1 gm fat = 9 calories
                        </p>
                    </div>
                    <form method="post" id="mGoal" class="bg-white rounded-lg shadow-lg p-4 text-black space-y-4">
                        <h1 class="text-2xl font-bold">Intake Per Day</h1>
                        <div class="flex flex-col gap-2">
                            <p class="font-medium text-sm">
                                Protein (gm)
                            </p>
                            <p id="protein"
                                class="bg-gray-200 p-2 border border-black/10 rounded-md focus:outline-black/20 text-sm">
                                0
                            </p>
                        </div>
                        <div class="flex flex-col gap-2">
                            <label for="fat" class="font-medium text-sm">Fat (How much fat you want to eat in
                                gm)</label>
                            <div class="flex gap-2 items-center">

                                <input type="number" id="fat" name="fat"
                                    class="bg-gray-200 p-2 border border-black/10 rounded-md focus:outline-black/20 text-sm">
                                <div class="bg-blue-500 p-2 rounded-md text-white">
                                    <input type="submit" value="Submit">
                                </div>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-sm">
                                Carbs (gm)
                            </p>
                            <p id="carbs"
                                class="bg-gray-200 p-2 border border-black/10 rounded-md focus:outline-black/20 text-sm">
                                0
                            </p>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <script>
        const mCal = localStorage.getItem("maintenance_calorie")
        if (!mCal) {
            window.location.href = "/calorie"
            alert("Please enter your maintenance calorie")
        }
    </script>

    <script>
        const protein = document.getElementById("protein")
        const userEmail = localStorage.getItem("email")

        fetch('http://localhost:5000/users/' + userEmail)
            .then(async (res) => {
                const data = await res.json()
                protein.innerHTML = (data.weight / 0.46).toFixed(2)
            })
    </script>

    <script>
        const form = document.getElementById("mGoal")
        form.addEventListener("submit", (e) => {
            e.preventDefault()
            const formData = new FormData(form)
            const email = localStorage.getItem("email")
            const m_cal = localStorage.getItem("maintenance_calorie")

            formData.append("email", email)
            formData.append("m_cal", m_cal)

            fetch('http://localhost:5000/diet', {
                method: "POST",
                body: formData
            })
                .then(async (res) => {
                    if (!res.ok) {
                        const data = await res.json()
                        throw new Error(data.error)
                    }

                    const data = await res.json()
                    const carbs = document.getElementById("carbs")
                    carbs.innerHTML = data.carb
                })
                .catch((err) => {
                    console.error(err)
                    if (err instanceof Error)
                        alert(err.message)
                    else
                        alert('Something went wrong')
                })
        })
    </script>
</body>